function changePage(s){var e="#"+s;e=e.replace("btn-alliance-new-mission","buildings_outer"),e=e.replace("-aa","_outer"),$(e)[0]?("#settings_outer"==e?(actuvem=!1,$("#settings-spin").addClass("fa-spin").css("z-index","999"),$("#building_helper").is(":checked")||$("#missions_outer,#chat_outer,#buildings_outer,#radio_outer,#map_outer").css("opacity","0.3").css("filter","blur(7px)").css("-webkit-filter","blur(7px)").css("-moz-filter","blur(7px)").css("-o-filter","blur(7px)").css("-ms-filter","blur(7px)"),$("#missions-aa, #verband-aa, #buildings-aa, #chat-aa, #radio-aa").addClass("disabled")):$("#settings-spin").removeClass("fa-spin"),$(curwindow).fadeOut(500),$(curwindow).slideUp(1e3),$(e).fadeIn(500),$(e).slideDown(1e3),curwindow=e):alert('Could not find page "'+e+'".\r\nReport to us immediately!')}function get_buildings(){var s=[];return $("#building_list").find(".building_list_li").each(function(e,i){var a=$(i).find(".building_list_caption").find(".building_marker_image").attr("building_id"),t=$(i).find(".building_list_caption").find(".map_position_mover").html(),n=$(i).find(".building_list_caption").find(".map_position_mover").attr("data-latitude"),l=$(i).find(".building_list_caption").find(".map_position_mover").attr("data-longitude"),c=$(i).attr("building_type_id"),o={stationId:a,stationName:t,stationLat:n,stationLng:l,stationType:c};s.push(o)}),s}function car_list(s){return data=[],$("#vehicle_building_"+s).find("li").each(function(s,e){data.push({id:$(e).attr("vehicle_id"),name:$(e).find("a").html(),type:$(e).find("a").attr("vehicle_type_id"),fms:$(e).find(".building_list_fms").html()})}),data}function car_list_printable(s){return data="",$.each(s,function(s,e){data+="<br>&nbsp;&nbsp;&nbsp;<span class='building_list_fms building_list_fms_"+e.fms+"'>"+e.fms+"</span> "+e.name}),data}function drawCircles(s){$.each(markers,function(s,e){map.removeLayer(e)}),markers=[],data=get_buildings(),map.attributionControl.addAttribution("Wachen-Planung by Lost &amp; Northdegree"),map.invalidateSize(!0),$.each(data,function(e,i){if(col="red",draw=!1,0==i.stationType&&$("#mark_fw").is(":checked")?draw=!0:6==i.stationType&&$("#mark_pol").is(":checked")?(draw=!0,col="green"):2==i.stationType&&$("#mark_rw").is(":checked")?(draw=!0,col="orange"):9==i.stationType&&$("#mark_thw").is(":checked")?(draw=!0,col="darkblue"):11==i.stationType&&$("#mark_bp").is(":checked")?(draw=!0,col="lightblue"):4==i.stationType&&$("#mark_kh").is(":checked")&&(draw=!0,col="black"),1==draw){cars="<span class='building_leaflet_text' style='z-index:99999; color: "+col+";'><i class='fa fa-building'></i> "+i.stationName+"</span>",cars+=car_list_printable(car_list(i.stationId));var a=L.circle([i.stationLat,i.stationLng],s,{color:col,fillOpacity:.3,riseOnHover:!0}).addTo(map);a.bindLabel(cars),markers.push(a)}})}function redraw_buildings(){$.each(building_markers,function(s,e){cars=car_list(e.building_id),data=e.options.title,cars.length>0&&(data+='&nbsp;<i class="fa fa-car"></i>'+cars.length,data+=car_list_printable(cars)),e.bindLabel(data,{zIndex:999})}),building_maps_redraw()}function d_v4(){$("#s-v4").is(":checked")?(vv4=!0,$("#s_close").css("display","block"),$("#map").css("height","550px"),$("#missions_outer").css("display",""),$("#missions-panel-body").css("height","1320px"),$("footer").css("display","none"),$("#buildings_outer").removeAttr("style").css("left","-10px").css("right","asdf").css("width","23%").css("display","").css("top","asdf").css("margin-top","520px").fadeIn(500).slideDown(1e3),$("#chat_outer").removeAttr("style").css("left","21.5%").css("right","asdf").css("width","23%").css("display","none").css("top","asdf").css("margin-top","520px").fadeIn(500).slideDown(1e3),$("#radio_outer").css("opacity","1").css("display","none").css("width","22%").css("right","34.5%").css("left","asdf").css("top","asdf").css("margin-top","520px").fadeIn(500).slideDown(1e3),$("#settings_outer").css("display","").css("z-index","999").fadeOut(500),$("#missions-aa, #verband-aa, #buildings-aa, #chat-aa, #radio-aa").addClass("disabled"),$("#missions_outer,#chat_outer,#buildings_outer,#radio_outer,#map_outer").css("opacity","1").css("filter","").css("-webkit-filter","").css("-moz-filter","").css("-o-filter","").css("-ms-filter",""),$("#settings-spin").removeClass("fa-spin")):(vv4=!1,$("#missions_outer,#buildings_outer,#chat_outer,#radio_outer").removeAttr("style"),$("#missions_outer,#buildings_outer,#chat_outer,#radio_outer").css("display","none").css("width","33%").css("right","0").css("position","absolute"),$("#map").css("height","900px"),$("#map-switch").css("background-color",""),$("#missions-aa, #verband-aa, #buildings-aa, #chat-aa, #radio-aa").addClass("disabled"),$("#settings_outer").css("z-index",""),$("#missions-panel-body").css("height","850px"))}function mapMode(){$("#myonoffswitch").is(":checked")?(nomap=!0,$("#map").css("display","none"),$("#s_close").css("display","block"),$("#missions_outer").removeAttr("style").css("left","0").css("width","25%").css("display","none").fadeIn(500).slideDown(1e3),$("#buildings_outer").removeAttr("style").css("left","25%").css("width","25%").css("display","none").fadeIn(500).slideDown(1e3),$("#chat_outer").removeAttr("style").css("left","50%").css("width","25%").css("display","none").fadeIn(500).slideDown(1e3),$("#radio_outer").css("opacity","1").css("display","none").css("width","25%").css("right","0").css("margin-top","").fadeIn(500).slideDown(1e3),$("#settings_outer").css("display","none").css("z-index","999"),$("#missions-aa, #verband-aa, #buildings-aa, #chat-aa, #radio-aa").addClass("disabled"),$("#missions_outer,#chat_outer,#buildings_outer,#radio_outer,#map_outer").css("opacity","1").css("filter","").css("-webkit-filter","").css("-moz-filter","").css("-o-filter","").css("-ms-filter",""),$("#settings-spin").removeClass("fa-spin")):(nomap=!1,$("#missions_outer,#buildings_outer,#chat_outer,#radio_outer").removeAttr("style"),$("#missions_outer,#buildings_outer,#chat_outer,#radio_outer").css("display","none").css("width","33%").css("right","0").css("position","absolute"),$("#map").css("display",""),$("#map-switch").css("background-color",""),$("#missions-aa, #verband-aa, #buildings-aa, #chat-aa, #radio-aa").addClass("disabled"),$("#settings_outer").css("z-index",""))}function build_help(){$("#building_helper").is(":checked")?($("#map_outer").css("opacity","1").css("filter","blur(0px)").css("-webkit-filter","blur(0px)").css("-moz-filter","blur(0px)").css("-o-filter","blur(0px)").css("-ms-filter","blur(0px)"),drawCircles($("#x_radius").is(":checked")?1e4:5e3)):($("#map_outer").css("opacity","0.3").css("filter","blur(7px)").css("-webkit-filter","blur(7px)").css("-moz-filter","blur(7px)").css("-o-filter","blur(7px)").css("-ms-filter","blur(7px)"),$.each(markers,function(s,e){map.removeLayer(e)}),markers=[],map.attributionControl.removeAttribution("Wachen-Planung by Lost &amp; Northdegree"))}function fms_switch(){$("#sw_verband").is(":checked")?nofms=!1:nofms=!0}var curwindow="#missions_outer";nomap=!1,vv4=!1,markers=[],mapfix=!1,nofms=!1;var buildingsById={0:"Feuerwache",1:"Feuerwehrschule",2:"Rettungswache",3:"Rettungsschule",4:"Krankenhaus",5:"Rettungshubschrauber-Station",6:"Polizeiwache",7:"Leitstelle",8:"Polizeischule",9:"THW",10:"THW Schule",11:"Bereitschaftspolizei"};$("head").append('<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">').append('<link href="https://fonts.googleapis.com/css?family=Titillium+Web" rel="stylesheet" type="text/css">').append('<link rel="stylesheet" href="http://lss.lost.design/lss-manager.css">'),$("a[class^='navbar-brand hidden-xs']").append("<a href='http://forum.leitstellenspiel.de/index.php/Thread/8077-REDESIGNS-by-lost/'><img src='http://i.imgur.com/cPr2nKr.png' style='width:250px; top: 10px;left: 0; position: absolute !important;'></a>"),$("a:contains('Im Verband freigeben')").attr("id","freigabe-verband"),$("a:contains('Vorheriger Einsatz')").attr("id","vorheriger-einsatz"),$("a:contains('Nächster Einsatz')").attr("id","nächster-einsatz"),$("a:contains('Sprechwunsch bearbeiten')").attr("id","sprechwunsch-bearbeiten"),$("a:contains('Zurück zum Einsatz')").attr("id","zurück-einsatz"),$("a:contains('Anfahren')").attr("id","nächstes-krankenhaus"),$("a:contains('Rückalarmieren')").attr("id","lf-zurück"),$("small:contains('Fahrzeuge ausgeblendet.')").css("display","none"),$(".panel-heading:contains('Einsätze')").css("background-color","#e74c3c").css("color","#fff"),$("li[id^='patient_']").attr("id","pat_pro"),$("div[id^='mission_patients_']").addClass("patient_progress"),$("div[class^='visible-xs']").before("<br>"),$(".logo").css("display","none"),$(document).keydown(function(s){if(!$("input").is(":focus")){if(68==s.keyCode)$("#nächster-einsatz")[0].click();else if(87==s.keyCode)$("#freigabe-verband")[0].click();else if(65==s.keyCode)$("#vorheriger-einsatz")[0].click();else if(83==s.keyCode)$("#alert_next").click();else if(81==s.keyCode)$("#sprechwunsch-bearbeiten")[0].click();else if(49==s.keyCode)$("#nächstes-krankenhaus")[0].click();else if(50==s.keyCode)$("#nächstes-krankenhaus")[1].click();else if(51==s.keyCode)$("#nächstes-krankenhaus")[2].click();else if(52==s.keyCode)$("#nächstes-krankenhaus")[3].click();else if(53==s.keyCode)$("#nächstes-krankenhaus")[4].click();else if(82==s.keyCode)$("#zurück-einsatz")[0].click();else if(69==s.keyCode)$("#lf-zurück")[0].click();else if(88==s.keyCode)$("#mission_alarm_btn")[0].click();else if(89==s.keyCode){var e=$("#missions > .panel > #missions-panel-body > #mission_list > .missionSideBarEntry > .panel > .panel-heading > a[href^='/missions/']");e[0].click()}return s.returnValue}}),$("#news_li").before('<div class="col-sm-4 overview_outer" id="settings_outer"><div id="settings1“ class="sidebar-nav"><div class="panel panel-default"><div class="panel-heading"><a href="#" id="s_close"><i class="fa fa-times-circle"></i></a>Einstellungen</div><div class="panel-body"><div class="col-md-12"><h4 style="line-height:0.5;">Leitstellenspiel</h4><div class="col-md-4">FMS5 Verbandsmitglieder<div class="onoffswitch"><input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox" id="sw_verband" checked><label class="onoffswitch-label" for="sw_verband"></label></div></div></div><div class="col-md-12"><br><h4 style="line-height:0.5;">Map</h4><div class="col-md-4"><!--<a href="#" id="map_reload" style="background-color:#f5f5f5;color:black;" class="btn btn-sm btn-info">Karte neu laden<i class="fa fa-refresh"></i></a>-->Karte neu ausrichten<div class="onoffswitch"><input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox" id="map_reload" unchecked><label class="onoffswitch-label" for="map_reload"></label></div></div><div class="col-md-4">Wachen-Planung<div class="onoffswitch"><input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox" id="building_helper" unchecked><label class="onoffswitch-label" for="building_helper"></label></div></div><div class="col-md-4">10 km Radius<div class="onoffswitch"><input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox" id="x_radius" unchecked><label class="onoffswitch-label" for="x_radius"></label></div></div></div><div class="col-md-12"><br><h4 style="line-height:0.5;">Markierungen</h4><div class="col-md-4"><!--<a href="#" id="map_reload" style="background-color:#f5f5f5;color:black;" class="btn btn-sm btn-info">Karte neu laden<i class="fa fa-refresh"></i></a>-->Feuerwehr<div class="onoffswitch"><input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox" id="mark_fw" checked><label class="onoffswitch-label" for="mark_fw"></label></div></div><div class="col-md-4">Polizei<div class="onoffswitch"><input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox" id="mark_pol" unchecked><label class="onoffswitch-label" for="mark_pol"></label></div></div><div class="col-md-4">Rettungsdienst<div class="onoffswitch"><input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox" id="mark_rw" unchecked><label class="onoffswitch-label" for="mark_rw"></label></div></div></div><div class="col-md-12"><div class="col-md-4"><!--<a href="#" id="map_reload" style="background-color:#f5f5f5;color:black;" class="btn btn-sm btn-info">Karte neu laden<i class="fa fa-refresh"></i></a>-->THW<div class="onoffswitch"><input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox" id="mark_thw" unchecked><label class="onoffswitch-label" for="mark_thw"></label></div></div><div class="col-md-4">Bereitschaftspolizei<div class="onoffswitch"><input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox" id="mark_bp" unchecked><label class="onoffswitch-label" for="mark_bp"></label></div></div><div class="col-md-4">Krankenhaus<div class="onoffswitch"><input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox" id="mark_kh" unchecked><label class="onoffswitch-label" for="mark_kh"></label></div></div></div><div class="col-md-12"><br><h4 style="line-height:0.5;">Design</h4><div class="btn-group" id="color-menu"><a href="#" class="btn btn-sm btn-default" id="rot-design" style="background-color: transparent;"><i class="fa fa-circle" style="color:#e74c3c;"></i> Rot</a><a href="#" class="btn btn-sm btn-default" id="rtw-design" style="background-color: transparent;"><i class="fa fa-circle" style="color:#F7CA18;"></i> Gelb</a><a href="#" class="btn btn-sm btn-default" id="pol-design" style="background-color: transparent;"><i class="fa fa-circle" style="color:#2ecc71;"></i> Grün</a><a href="#" class="btn btn-sm btn-default" id="thw-design" style="background-color: transparent;"><i class="fa fa-circle" style="color:#3498db;"></i> Blau</a><a href="#" class="btn btn-sm btn-default" id="orange-design" style="background-color: transparent;"><i class="fa fa-circle" style="color:#f39c12;"></i> Orange</a><a href="#" class="btn btn-sm btn-default" id="pink-design" style="background-color: transparent;"><i class="fa fa-circle" style="color:#D2527F;"></i> Pink</a><a href="#" class="btn btn-sm btn-default" id="grau-design" style="background-color: transparent;"><i class="fa fa-circle" style="color:#6C7A89;"></i> Grau</a> </div><br><br><div class="col-md-4">No Map Modus<div class="onoffswitch"><input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox" id="myonoffswitch" unchecked><label class="onoffswitch-label" for="myonoffswitch"></label></div></div><div class="col-md-4">Version 4 <div class="onoffswitch disabled"><input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox" id="s-v4" unchecked><label class="onoffswitch-label" for="s-v4"></label></div></div><div class="col-md-4">Version 5<div class="onoffswitch disabled"><input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox" id="s-v5" unchecked><label class="onoffswitch-label" for="s-v5"></label></div></div></div><div class="col-md-12"><br><br><h4 style="line-height:0.5;">Tastatur Alarmierung</h4><div class="col-md-6"><kbd>Y</kbd> = 1. Einsatz in der Liste öffnen<br><kbd>W</kbd> = Im Verband freigeben <br><kbd>S</kbd> = Alarmieren & weiter<br><kbd>X</kbd> = Alarmieren<br><kbd>A</kbd> = Vorheriger Einsatz</div><div class="col-md-6"><kbd>D</kbd> = Nächster Einsatz<br><kbd>E</kbd> = 1. FZ vom Einsatz rückalarmieren<br><kbd>Q</kbd> = Sprechwunsch bearbeiten<br><kbd>R</kbd> = Zurück zum Einsatz<br><kbd>1 - 5</kbd> = 1. - 5. KH anfahren</div></div><p><br><br><br><br><!--<h4 style="line-height:0.5;">Geplante Features, bekannte Fehler & sonstiges</h4><ul><li>FEHLER: Krankenhaus übersicht</li><li>FEHLER: Patienten gröÃƒÅ¸e in Alarmmaske</li><li>GEPLANT: Speicherfunktion der Einstellungen</li><li>GEPLANT: Anzeige der FMS 5 in der neuen Leiste</li><li>GEPLANT: Mehr Layouts</li><li>GEPLANT: IconSwitcher</li><li>GEPLANT: Blinken der FMS 5 für Firefox</li><li>GEPLANT: Fehlerbehebungen</li><li>GEPLANT: Design Anpassungen</li></ul>--><br><br><br></p><p style="margin-top:20px;">Es handelt sich immer noch um eine Beta Version, ich bin für keine Schäden verantwortlich. <br><br>Das Script steht in keinem Bezug zum Leitstellenspiel.de - Abänderungen sind erlaubt, das veröffentlichen jedoch nicht.<p><a href="http://forum.leitstellenspiel.de/index.php/Thread/8077-REDESIGNS-by-lost/" style="font-size:12px; font-weight:600;"><p>made with <i class="fa fa-heart" style="color:red; font-size: 14px;"></i> by lost</a><a href="http://forum.leitstellenspiel.de/index.php/User/5627-Northdegree/" style="font-size:12px; font-weight:600; color:#e67e22;"> and some extra <i class="fa fa-heart" style="color:red; font-size: 14px;"></i> by Northdegree</a><p style="font-size:8px;">Verband Feuerwehr München & Umgebung</p></p></p></div></div></div>'),$("#news_li").before('<div class="col-sm-4 overview_outer" id="verband_outer"><div id="verband1" class="sidebar-nav"><div class="panel panel-default" id="verband_einsatz"><div class="panel-heading" id="verband-head">Verbands-Einsätze</div><div class="panel-body" id="missions-panel-body"></div></div></div></div>'),$("#missions_outer").before('<div class="btn-group-vertical" id="lost-menu"><a href="#" class="btn btn-sm btn-default" id="missions-aa" data-toggle="tooltip" data-placement="left" title="Einsätze"><i id="missions-fire" class="fa fa-fire"></i></a><a href="#" class="btn btn-sm btn-default" id="verband-aa" data-toggle="tooltip" data-placement="left" title="Verband"><i class="fa fa-fire"></i></a><a href="#" class="btn btn-sm btn-default" id="radio-aa" data-toggle="tooltip" data-placement="left" title="Funksprüche"><i id="radio-spin" class="fa fa-feed"></i></a><a href="#" class="btn btn-sm btn-default" id="buildings-aa" data-toggle="tooltip" data-placement="left" title="Wachen"><i id="buildings-spin" class="fa fa-building-o"></i></a><a href="#" class="btn btn-sm btn-default" id="chat-aa" data-toggle="tooltip" data-placement="left" title="Chat"><i id="chat-spin" class="fa fa-comment-o"></i></a><a href="#" class="btn btn-sm btn-default" id="settings-aa" style="font-weight:600; font-size:25px;" data-toggle="tooltip" data-placement="left" title="Einstellungen"><i id="settings-spin" class="fa fa-cog"></i></a></div>'),$("#missions-aa, #verband-aa, #radio-aa, #buildings-aa, #settings-aa, #chat-aa").tooltip(),$("#mission_select_alliance").css("display","none"),$("#mission_list_alliance").detach().appendTo("#verband_einsatz #missions-panel-body"),$("#map-switch").click(function(){$(this).find("i").toggleClass("fa-toggle-on fa-toggle-off")}),$(function(){for(var s=0;200>s;s++)$("#missions-fire").animate({color:"#f39c12"},800).animate({color:"#ea6153"},800).animate({color:"#f1c40f"},800)}),$("[id$=-design]").click(function(){var s="#e74c3c",e=$(this).attr("id");"rtw-design"==e?s="#F7CA18":"pol-design"==e?s="#2ecc71":"thw-design"==e?s="#3498db":"orange-design"==e?s="#f39c12":"pink-design"==e?s="#D2527F":"grau-design"==e&&(s="#6C7A89"),$(".navbar-default").css("background-color",s+" !important"),$("#chat_outer .panel-heading, #radio_outer .panel-heading, #buildings_outer .panel-heading, #missions_outer .panel-heading, #verband_outer .panel-heading, #settings_outer .panel-heading").css("background-color",s).css("color","#fff"),$("div[id^='mission_panel_heading']").css("background-color","").css("color","#34495e")}),$(function(){for(var s=0;200>s;s++)$("#missions-fire").animate({color:"#f39c12"},800).animate({color:"#ea6153"},800).animate({color:"#f1c40f"},800)}),$("[id$=-aa],#btn-alliance-new-mission").click(function(){changePage($(this).attr("id"))}),$("#reset").click(function(){location.reload()}),$("#s_close").click(function(){$("#missions_outer").css("display",""),changePage("missions_outer"),$("#settings_outer").css("z-index","999"),$("#missions_outer,#chat_outer,#buildings_outer,#radio_outer,#map_outer,#settings_outer").css("opacity","1").css("filter","").css("-webkit-filter","").css("-moz-filter","").css("-o-filter","").css("-ms-filter",""),$("#missions-aa, #verband-aa, #buildings-aa, #chat-aa, #radio-aa").removeClass("disabled"),$("#settings-spin").removeClass("fa-spin")}),"undefined"!=typeof map&&map.on("mousedown",function(){mapfix||(map.invalidateSize(!0),mapfix=!0)});var org_radioMessage=radioMessage;radioMessage=function(s){return"vehicle_fms"==s.type&&5==s.fms&&s.user_id!=user_id&&1==nofms?!1:(s.user_id==user_id&&redraw_buildings(),void org_radioMessage(s))};var org_building_maps_draw=building_maps_draw;building_maps_draw=function(s){var e=L.marker([s.latitude,s.longitude],{title:s.name,icon:icon_empty,riseOnHover:!0}).bindLabel(s.name).addTo(map);e.building_id=s.id,"undefined"!=typeof s.opacity&&e.setOpacity(s.opacity),iconMapGenerate(s.building_marker_image,e),e.on("click",function(){lightboxOpen("/buildings/"+s.id)}),building_markers.push(e),$.each(building_markers,function(s,e){e.hideLabel(),e.unbindLabel(),cars=car_list(e.building_id),data=e.options.title,cars.length>0&&(data+='&nbsp;<i class="fa fa-car"></i>'+cars.length,data+=car_list_printable(cars)),e.bindLabel(data,{zIndex:999})})},$("#s-v4").click(d_v4),$("#myonoffswitch").click(mapMode),$("#x_radius,#mark_kh,#mark_bp,#mark_thw,#mark_rw,#mark_pol,#mark_fw").click(function(){$("#building_helper").is(":checked")&&drawCircles($("#x_radius").is(":checked")?1e4:5e3)}),$("#building_helper").click(build_help),$("#sw_verband").click(fms_switch),$("#map_reload").click(function(){setTimeout(function(){$("#map_reload").attr("checked",!1),map.invalidateSize(!0)},300)}),redraw_buildings();
